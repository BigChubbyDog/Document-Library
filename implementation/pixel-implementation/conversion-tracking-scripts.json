{
  "lead_form_submission": {
    "inline_script": "\n// Track Mortgage application form submission\nfunction trackLeadFormSubmission(customerData = {}) {\n  if (typeof window.mortgageTracking !== 'undefined') {\n    window.mortgageTracking.trackConversion('Lead', {\n      content_name: 'Mortgage application form submission',\n      value: 150,\n      currency: 'USD'\n    }, customerData);\n  }\n}\n\n// Auto-trigger for URL-based events\nif (window.location.pathname.includes('/application/submit')) {\n  document.addEventListener('DOMContentLoaded', function() {\n    trackLeadFormSubmission();\n  });\n}\n\n// Auto-trigger for element-based events\ndocument.addEventListener('DOMContentLoaded', function() {\n  const triggerElement = document.querySelector('#mortgage-application-form');\n  if (triggerElement) {\n    triggerElement.addEventListener('submit', function(e) {\n      // Extract form data if available\n      const formData = new FormData(e.target);\n      const customerData = {\n        email: formData.get('email') || formData.get('user_email'),\n        phone: formData.get('phone') || formData.get('user_phone'),\n        firstName: formData.get('first_name') || formData.get('firstName'),\n        lastName: formData.get('last_name') || formData.get('lastName'),\n        city: formData.get('city'),\n        state: formData.get('state'),\n        zipCode: formData.get('zip') || formData.get('zipCode')\n      };\n      \n      trackLeadFormSubmission(customerData);\n    });\n  }\n});",
    "gtm_trigger": "{\n  \"trigger\": {\n    \"type\": \"customEvent\",\n    \"customEventFilter\": [\n      {\n        \"type\": \"equals\",\n        \"parameter\": [\n          {\n            \"type\": \"template\",\n            \"template\": \"{{Event}}\"\n          },\n          {\n            \"type\": \"template\", \n            \"template\": \"lead_form_submission\"\n          }\n        ]\n      }\n    ]\n  },\n  \"tag\": {\n    \"type\": \"html\",\n    \"html\": \"fbq('track', 'Lead', {value: 150, currency: 'USD', content_category: 'mortgage_services'});\"\n  }\n}",
    "server_side_tracking": "\n// Server-side conversion tracking for Mortgage application form submission\nconst FacebookConversionsAPI = require('./FacebookConversionsAPI');\n\napp.post('/application/submit', async (req, res) => {\n  try {\n    // Process the form/request\n    const customerData = {\n      email: req.body.email,\n      phone: req.body.phone,\n      firstName: req.body.first_name || req.body.firstName,\n      lastName: req.body.last_name || req.body.lastName,\n      city: req.body.city,\n      state: req.body.state,\n      zipCode: req.body.zip || req.body.zipCode\n    };\n    \n    // Track conversion server-side\n    const fbAPI = new FacebookConversionsAPI();\n    await fbAPI.trackConversion('lead_form_submission', customerData, {\n      value: 150,\n      url: req.get('Referer') || 'https://mortgagelc.com/application/submit',\n      fbp: req.cookies._fbp,\n      fbc: req.cookies._fbc\n    });\n    \n    res.json({ success: true });\n  } catch (error) {\n    console.error('Conversion tracking failed:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});"
  },
  "quote_request": {
    "inline_script": "\n// Track Mortgage rate quote request\nfunction trackQuoteRequest(customerData = {}) {\n  if (typeof window.mortgageTracking !== 'undefined') {\n    window.mortgageTracking.trackConversion('InitiateCheckout', {\n      content_name: 'Mortgage rate quote request',\n      value: 75,\n      currency: 'USD'\n    }, customerData);\n  }\n}\n\n// Auto-trigger for URL-based events\nif (window.location.pathname.includes('/quote/request')) {\n  document.addEventListener('DOMContentLoaded', function() {\n    trackQuoteRequest();\n  });\n}\n\n// Auto-trigger for element-based events\ndocument.addEventListener('DOMContentLoaded', function() {\n  const triggerElement = document.querySelector('#quote-form');\n  if (triggerElement) {\n    triggerElement.addEventListener('submit', function(e) {\n      // Extract form data if available\n      const formData = new FormData(e.target);\n      const customerData = {\n        email: formData.get('email') || formData.get('user_email'),\n        phone: formData.get('phone') || formData.get('user_phone'),\n        firstName: formData.get('first_name') || formData.get('firstName'),\n        lastName: formData.get('last_name') || formData.get('lastName'),\n        city: formData.get('city'),\n        state: formData.get('state'),\n        zipCode: formData.get('zip') || formData.get('zipCode')\n      };\n      \n      trackQuoteRequest(customerData);\n    });\n  }\n});",
    "gtm_trigger": "{\n  \"trigger\": {\n    \"type\": \"customEvent\",\n    \"customEventFilter\": [\n      {\n        \"type\": \"equals\",\n        \"parameter\": [\n          {\n            \"type\": \"template\",\n            \"template\": \"{{Event}}\"\n          },\n          {\n            \"type\": \"template\", \n            \"template\": \"quote_request\"\n          }\n        ]\n      }\n    ]\n  },\n  \"tag\": {\n    \"type\": \"html\",\n    \"html\": \"fbq('track', 'InitiateCheckout', {value: 75, currency: 'USD', content_category: 'mortgage_services'});\"\n  }\n}",
    "server_side_tracking": "\n// Server-side conversion tracking for Mortgage rate quote request\nconst FacebookConversionsAPI = require('./FacebookConversionsAPI');\n\napp.post('/quote/request', async (req, res) => {\n  try {\n    // Process the form/request\n    const customerData = {\n      email: req.body.email,\n      phone: req.body.phone,\n      firstName: req.body.first_name || req.body.firstName,\n      lastName: req.body.last_name || req.body.lastName,\n      city: req.body.city,\n      state: req.body.state,\n      zipCode: req.body.zip || req.body.zipCode\n    };\n    \n    // Track conversion server-side\n    const fbAPI = new FacebookConversionsAPI();\n    await fbAPI.trackConversion('quote_request', customerData, {\n      value: 75,\n      url: req.get('Referer') || 'https://mortgagelc.com/quote/request',\n      fbp: req.cookies._fbp,\n      fbc: req.cookies._fbc\n    });\n    \n    res.json({ success: true });\n  } catch (error) {\n    console.error('Conversion tracking failed:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});"
  },
  "preapproval_start": {
    "inline_script": "\n// Track Pre-approval application started\nfunction trackPreapprovalStart(customerData = {}) {\n  if (typeof window.mortgageTracking !== 'undefined') {\n    window.mortgageTracking.trackConversion('AddToCart', {\n      content_name: 'Pre-approval application started',\n      value: 100,\n      currency: 'USD'\n    }, customerData);\n  }\n}\n\n// Auto-trigger for URL-based events\nif (window.location.pathname.includes('/preapproval/start')) {\n  document.addEventListener('DOMContentLoaded', function() {\n    trackPreapprovalStart();\n  });\n}\n\n// Auto-trigger for element-based events\ndocument.addEventListener('DOMContentLoaded', function() {\n  const triggerElement = document.querySelector('#preapproval-form');\n  if (triggerElement) {\n    triggerElement.addEventListener('submit', function(e) {\n      // Extract form data if available\n      const formData = new FormData(e.target);\n      const customerData = {\n        email: formData.get('email') || formData.get('user_email'),\n        phone: formData.get('phone') || formData.get('user_phone'),\n        firstName: formData.get('first_name') || formData.get('firstName'),\n        lastName: formData.get('last_name') || formData.get('lastName'),\n        city: formData.get('city'),\n        state: formData.get('state'),\n        zipCode: formData.get('zip') || formData.get('zipCode')\n      };\n      \n      trackPreapprovalStart(customerData);\n    });\n  }\n});",
    "gtm_trigger": "{\n  \"trigger\": {\n    \"type\": \"customEvent\",\n    \"customEventFilter\": [\n      {\n        \"type\": \"equals\",\n        \"parameter\": [\n          {\n            \"type\": \"template\",\n            \"template\": \"{{Event}}\"\n          },\n          {\n            \"type\": \"template\", \n            \"template\": \"preapproval_start\"\n          }\n        ]\n      }\n    ]\n  },\n  \"tag\": {\n    \"type\": \"html\",\n    \"html\": \"fbq('track', 'AddToCart', {value: 100, currency: 'USD', content_category: 'mortgage_services'});\"\n  }\n}",
    "server_side_tracking": "\n// Server-side conversion tracking for Pre-approval application started\nconst FacebookConversionsAPI = require('./FacebookConversionsAPI');\n\napp.post('/preapproval/start', async (req, res) => {\n  try {\n    // Process the form/request\n    const customerData = {\n      email: req.body.email,\n      phone: req.body.phone,\n      firstName: req.body.first_name || req.body.firstName,\n      lastName: req.body.last_name || req.body.lastName,\n      city: req.body.city,\n      state: req.body.state,\n      zipCode: req.body.zip || req.body.zipCode\n    };\n    \n    // Track conversion server-side\n    const fbAPI = new FacebookConversionsAPI();\n    await fbAPI.trackConversion('preapproval_start', customerData, {\n      value: 100,\n      url: req.get('Referer') || 'https://mortgagelc.com/preapproval/start',\n      fbp: req.cookies._fbp,\n      fbc: req.cookies._fbc\n    });\n    \n    res.json({ success: true });\n  } catch (error) {\n    console.error('Conversion tracking failed:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});"
  },
  "calculator_usage": {
    "inline_script": "\n// Track Mortgage calculator interaction\nfunction trackCalculatorUsage(customerData = {}) {\n  if (typeof window.mortgageTracking !== 'undefined') {\n    window.mortgageTracking.trackConversion('ViewContent', {\n      content_name: 'Mortgage calculator interaction',\n      value: 25,\n      currency: 'USD'\n    }, customerData);\n  }\n}\n\n// Auto-trigger for URL-based events\nif (window.location.pathname.includes('/calculator')) {\n  document.addEventListener('DOMContentLoaded', function() {\n    trackCalculatorUsage();\n  });\n}\n\n// Auto-trigger for element-based events\ndocument.addEventListener('DOMContentLoaded', function() {\n  const triggerElement = document.querySelector('.mortgage-calculator');\n  if (triggerElement) {\n    triggerElement.addEventListener('submit', function(e) {\n      // Extract form data if available\n      const formData = new FormData(e.target);\n      const customerData = {\n        email: formData.get('email') || formData.get('user_email'),\n        phone: formData.get('phone') || formData.get('user_phone'),\n        firstName: formData.get('first_name') || formData.get('firstName'),\n        lastName: formData.get('last_name') || formData.get('lastName'),\n        city: formData.get('city'),\n        state: formData.get('state'),\n        zipCode: formData.get('zip') || formData.get('zipCode')\n      };\n      \n      trackCalculatorUsage(customerData);\n    });\n  }\n});",
    "gtm_trigger": "{\n  \"trigger\": {\n    \"type\": \"customEvent\",\n    \"customEventFilter\": [\n      {\n        \"type\": \"equals\",\n        \"parameter\": [\n          {\n            \"type\": \"template\",\n            \"template\": \"{{Event}}\"\n          },\n          {\n            \"type\": \"template\", \n            \"template\": \"calculator_usage\"\n          }\n        ]\n      }\n    ]\n  },\n  \"tag\": {\n    \"type\": \"html\",\n    \"html\": \"fbq('track', 'ViewContent', {value: 25, currency: 'USD', content_category: 'mortgage_services'});\"\n  }\n}",
    "server_side_tracking": "\n// Server-side conversion tracking for Mortgage calculator interaction\nconst FacebookConversionsAPI = require('./FacebookConversionsAPI');\n\napp.post('/calculator', async (req, res) => {\n  try {\n    // Process the form/request\n    const customerData = {\n      email: req.body.email,\n      phone: req.body.phone,\n      firstName: req.body.first_name || req.body.firstName,\n      lastName: req.body.last_name || req.body.lastName,\n      city: req.body.city,\n      state: req.body.state,\n      zipCode: req.body.zip || req.body.zipCode\n    };\n    \n    // Track conversion server-side\n    const fbAPI = new FacebookConversionsAPI();\n    await fbAPI.trackConversion('calculator_usage', customerData, {\n      value: 25,\n      url: req.get('Referer') || 'https://mortgagelc.com/calculator',\n      fbp: req.cookies._fbp,\n      fbc: req.cookies._fbc\n    });\n    \n    res.json({ success: true });\n  } catch (error) {\n    console.error('Conversion tracking failed:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});"
  },
  "consultation_booking": {
    "inline_script": "\n// Track Consultation appointment booked\nfunction trackConsultationBooking(customerData = {}) {\n  if (typeof window.mortgageTracking !== 'undefined') {\n    window.mortgageTracking.trackConversion('Schedule', {\n      content_name: 'Consultation appointment booked',\n      value: 125,\n      currency: 'USD'\n    }, customerData);\n  }\n}\n\n// Auto-trigger for URL-based events\nif (window.location.pathname.includes('/consultation/book')) {\n  document.addEventListener('DOMContentLoaded', function() {\n    trackConsultationBooking();\n  });\n}\n\n// Auto-trigger for element-based events\ndocument.addEventListener('DOMContentLoaded', function() {\n  const triggerElement = document.querySelector('#consultation-form');\n  if (triggerElement) {\n    triggerElement.addEventListener('submit', function(e) {\n      // Extract form data if available\n      const formData = new FormData(e.target);\n      const customerData = {\n        email: formData.get('email') || formData.get('user_email'),\n        phone: formData.get('phone') || formData.get('user_phone'),\n        firstName: formData.get('first_name') || formData.get('firstName'),\n        lastName: formData.get('last_name') || formData.get('lastName'),\n        city: formData.get('city'),\n        state: formData.get('state'),\n        zipCode: formData.get('zip') || formData.get('zipCode')\n      };\n      \n      trackConsultationBooking(customerData);\n    });\n  }\n});",
    "gtm_trigger": "{\n  \"trigger\": {\n    \"type\": \"customEvent\",\n    \"customEventFilter\": [\n      {\n        \"type\": \"equals\",\n        \"parameter\": [\n          {\n            \"type\": \"template\",\n            \"template\": \"{{Event}}\"\n          },\n          {\n            \"type\": \"template\", \n            \"template\": \"consultation_booking\"\n          }\n        ]\n      }\n    ]\n  },\n  \"tag\": {\n    \"type\": \"html\",\n    \"html\": \"fbq('track', 'Schedule', {value: 125, currency: 'USD', content_category: 'mortgage_services'});\"\n  }\n}",
    "server_side_tracking": "\n// Server-side conversion tracking for Consultation appointment booked\nconst FacebookConversionsAPI = require('./FacebookConversionsAPI');\n\napp.post('/consultation/book', async (req, res) => {\n  try {\n    // Process the form/request\n    const customerData = {\n      email: req.body.email,\n      phone: req.body.phone,\n      firstName: req.body.first_name || req.body.firstName,\n      lastName: req.body.last_name || req.body.lastName,\n      city: req.body.city,\n      state: req.body.state,\n      zipCode: req.body.zip || req.body.zipCode\n    };\n    \n    // Track conversion server-side\n    const fbAPI = new FacebookConversionsAPI();\n    await fbAPI.trackConversion('consultation_booking', customerData, {\n      value: 125,\n      url: req.get('Referer') || 'https://mortgagelc.com/consultation/book',\n      fbp: req.cookies._fbp,\n      fbc: req.cookies._fbc\n    });\n    \n    res.json({ success: true });\n  } catch (error) {\n    console.error('Conversion tracking failed:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});"
  },
  "loan_application": {
    "inline_script": "\n// Track Complete loan application submitted\nfunction trackLoanApplication(customerData = {}) {\n  if (typeof window.mortgageTracking !== 'undefined') {\n    window.mortgageTracking.trackConversion('Purchase', {\n      content_name: 'Complete loan application submitted',\n      value: 300,\n      currency: 'USD'\n    }, customerData);\n  }\n}\n\n// Auto-trigger for URL-based events\nif (window.location.pathname.includes('/loan/submit')) {\n  document.addEventListener('DOMContentLoaded', function() {\n    trackLoanApplication();\n  });\n}\n\n// Auto-trigger for element-based events\ndocument.addEventListener('DOMContentLoaded', function() {\n  const triggerElement = document.querySelector('#loan-application-form');\n  if (triggerElement) {\n    triggerElement.addEventListener('submit', function(e) {\n      // Extract form data if available\n      const formData = new FormData(e.target);\n      const customerData = {\n        email: formData.get('email') || formData.get('user_email'),\n        phone: formData.get('phone') || formData.get('user_phone'),\n        firstName: formData.get('first_name') || formData.get('firstName'),\n        lastName: formData.get('last_name') || formData.get('lastName'),\n        city: formData.get('city'),\n        state: formData.get('state'),\n        zipCode: formData.get('zip') || formData.get('zipCode')\n      };\n      \n      trackLoanApplication(customerData);\n    });\n  }\n});",
    "gtm_trigger": "{\n  \"trigger\": {\n    \"type\": \"customEvent\",\n    \"customEventFilter\": [\n      {\n        \"type\": \"equals\",\n        \"parameter\": [\n          {\n            \"type\": \"template\",\n            \"template\": \"{{Event}}\"\n          },\n          {\n            \"type\": \"template\", \n            \"template\": \"loan_application\"\n          }\n        ]\n      }\n    ]\n  },\n  \"tag\": {\n    \"type\": \"html\",\n    \"html\": \"fbq('track', 'Purchase', {value: 300, currency: 'USD', content_category: 'mortgage_services'});\"\n  }\n}",
    "server_side_tracking": "\n// Server-side conversion tracking for Complete loan application submitted\nconst FacebookConversionsAPI = require('./FacebookConversionsAPI');\n\napp.post('/loan/submit', async (req, res) => {\n  try {\n    // Process the form/request\n    const customerData = {\n      email: req.body.email,\n      phone: req.body.phone,\n      firstName: req.body.first_name || req.body.firstName,\n      lastName: req.body.last_name || req.body.lastName,\n      city: req.body.city,\n      state: req.body.state,\n      zipCode: req.body.zip || req.body.zipCode\n    };\n    \n    // Track conversion server-side\n    const fbAPI = new FacebookConversionsAPI();\n    await fbAPI.trackConversion('loan_application', customerData, {\n      value: 300,\n      url: req.get('Referer') || 'https://mortgagelc.com/loan/submit',\n      fbp: req.cookies._fbp,\n      fbc: req.cookies._fbc\n    });\n    \n    res.json({ success: true });\n  } catch (error) {\n    console.error('Conversion tracking failed:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});"
  },
  "email_signup": {
    "inline_script": "\n// Track Newsletter or updates subscription\nfunction trackEmailSignup(customerData = {}) {\n  if (typeof window.mortgageTracking !== 'undefined') {\n    window.mortgageTracking.trackConversion('Subscribe', {\n      content_name: 'Newsletter or updates subscription',\n      value: 15,\n      currency: 'USD'\n    }, customerData);\n  }\n}\n\n// Auto-trigger for URL-based events\nif (window.location.pathname.includes('/newsletter/signup')) {\n  document.addEventListener('DOMContentLoaded', function() {\n    trackEmailSignup();\n  });\n}\n\n// Auto-trigger for element-based events\ndocument.addEventListener('DOMContentLoaded', function() {\n  const triggerElement = document.querySelector('#newsletter-form');\n  if (triggerElement) {\n    triggerElement.addEventListener('submit', function(e) {\n      // Extract form data if available\n      const formData = new FormData(e.target);\n      const customerData = {\n        email: formData.get('email') || formData.get('user_email'),\n        phone: formData.get('phone') || formData.get('user_phone'),\n        firstName: formData.get('first_name') || formData.get('firstName'),\n        lastName: formData.get('last_name') || formData.get('lastName'),\n        city: formData.get('city'),\n        state: formData.get('state'),\n        zipCode: formData.get('zip') || formData.get('zipCode')\n      };\n      \n      trackEmailSignup(customerData);\n    });\n  }\n});",
    "gtm_trigger": "{\n  \"trigger\": {\n    \"type\": \"customEvent\",\n    \"customEventFilter\": [\n      {\n        \"type\": \"equals\",\n        \"parameter\": [\n          {\n            \"type\": \"template\",\n            \"template\": \"{{Event}}\"\n          },\n          {\n            \"type\": \"template\", \n            \"template\": \"email_signup\"\n          }\n        ]\n      }\n    ]\n  },\n  \"tag\": {\n    \"type\": \"html\",\n    \"html\": \"fbq('track', 'Subscribe', {value: 15, currency: 'USD', content_category: 'mortgage_services'});\"\n  }\n}",
    "server_side_tracking": "\n// Server-side conversion tracking for Newsletter or updates subscription\nconst FacebookConversionsAPI = require('./FacebookConversionsAPI');\n\napp.post('/newsletter/signup', async (req, res) => {\n  try {\n    // Process the form/request\n    const customerData = {\n      email: req.body.email,\n      phone: req.body.phone,\n      firstName: req.body.first_name || req.body.firstName,\n      lastName: req.body.last_name || req.body.lastName,\n      city: req.body.city,\n      state: req.body.state,\n      zipCode: req.body.zip || req.body.zipCode\n    };\n    \n    // Track conversion server-side\n    const fbAPI = new FacebookConversionsAPI();\n    await fbAPI.trackConversion('email_signup', customerData, {\n      value: 15,\n      url: req.get('Referer') || 'https://mortgagelc.com/newsletter/signup',\n      fbp: req.cookies._fbp,\n      fbc: req.cookies._fbc\n    });\n    \n    res.json({ success: true });\n  } catch (error) {\n    console.error('Conversion tracking failed:', error);\n    res.status(500).json({ error: 'Internal server error' });\n  }\n});"
  }
}
